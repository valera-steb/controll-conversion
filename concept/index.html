<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <link href="styles.css" rel="stylesheet" type="text/css">

    <script src="../lib/jquery/jquery-1.11.0.min.js"></script>
    <script src="../lib/knockout/knockout-3.1.0.js"></script>
    <script src="../lib/requirejs/require.js"
            data-main="config"></script>
</head>
<body>
<div id="ou-container">
    <div id="ou">
        Введите url <br/>
        <input data-bind="value: url">

        <div data-bind="text: data"></div>

        <div data-bind="visible: isLoading">loading....</div>
        <div data-bind="visible: hasError">error</div>
    </div>

    <div id="stub">
        модель сервера
        <div class="active">
            активен <input type="checkbox">
        </div>

        <div class="data">
            Данные <input> <br/>
            <button>Отправить</button> <br/>
        </div>

        <div class="cancel">
            <button>Подтвердить отмену запроса</button>
        </div>
    </div>
</div>

<br/>

<div id="si">
    <table>
        <tbody class="matrix">
        <tr>
            <td data-bind="template: {
                    name: 'generalConcept-template',
                    data: generalConcept
                }"></td>

            <td data-bind="template: {
                    name: 'targets-template',
                    data: targets
                }"></td>

            <td width="500">
                <div data-bind="foreach: tree">
                    <div data-bind="template: {
                    name: 'objectTree-template',
                    data: $data
                }"></div>
                </div>
            </td>
        </tr>
        <tr>
            <td></td>

            <td data-bind="template: {
                name:'stereotypes-template'
            }"></td>

            <td>
                <div data-bind="template: {
                    name: 'controlImpact-template',
                    data: controlImpact.impact
                }"></div>

                <div>Iteration: <span
                        data-bind="text: iteration"
                        ></span><br/>
                    <button data-bind="
                        click: controlImpact.actions.applyAll
                    ">apply all
                    </button>
                </div>
            </td>
        </tr>
        </tbody>
    </table>
</div>

<div id="templates">
    <script id="generalConcept-template" type="text/html">
        <!-- ko foreach: functions -->
        <div class="c-function"
             data-bind="
            text: description.name,
            css: {'active' : $parent.currentId() == description.name}
        "></div>
        <!-- /ko -->
    </script>

    <script id="stereotypes-template" type="text/html">
        <table>
            <tbody data-bind="foreach: stereotypes">
            <tr>
                <td data-bind="text: name"></td>

                <td data-bind="text: value"></td>
            </tr>
            </tbody>
        </table>
    </script>

    <script id="targets-template" type="text/html">
        <!-- ko foreach: $data -->
        <div class="target-wrapper"
             data-bind="css: {'target': subTargets}">
            <div class="target"
                 data-bind="
                    text: name,
                    css: mark"></div>

            <div class="sub-target"
                 data-bind="template: {
                    name: 'targets-template',
                    data: subTargets,
                    if: subTargets!=undefined
                }"></div>
        </div>
        <!-- /ko -->
    </script>

    <script id="objectTree-template" type="text/html">
        <a href="#"
           data-bind="click: expand">
            <span data-bind="text: name"
                    ></span>: <span data-bind="text: type"
                ></span>
        </a>

        <div data-bind="html: value"></div>

        <div class="sub-object-tree" data-bind="foreach: items">
            <!-- ko template: {
                name: 'objectTree-template',
                data: $data
            } -->
            <!-- /ko -->
        </div>
    </script>


    <script id="controlImpact-template" type="text/html">
        <!-- ko foreach: $data -->
        <div data-bind="text: JSON.stringify($data)"></div>
        <!-- /ko -->
    </script>
</div>
</body>
</html>